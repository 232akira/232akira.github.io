import{H as W,L as _,M as S,U as j,a as D,c as f,f as q,g as P,h as $,i as I,k as C,m as w,o as U,q as k,s as O}from"./chunk-MKDERDK7.js";import{a as F}from"./chunk-V4WAOXCU.js";import{a as v}from"./chunk-MEZ6MHDB.js";v();var re=(t,l,d,p)=>{let s,m="none";switch(l){case 0:s={opacity:[1,0]};break;case 1:s={opacity:[0,1]},m="block";break;case"bounceUpIn":s={begin(o){C(t,"block")},translateY:[{value:-60,duration:200},{value:10,duration:200},{value:-5,duration:200},{value:0,duration:200}],opacity:[0,1]},m="block";break;case"shrinkIn":s={begin(o){C(t,"block")},scale:[{value:1.1,duration:300},{value:1,duration:200}],opacity:1},m="block";break;case"slideRightIn":s={begin(o){C(t,"block")},translateX:["100%","0%"],opacity:[0,1]},m="block";break;case"slideRightOut":s={translateX:["0%","100%"],opacity:[1,0]};break;default:s=l,m=l.display;break}F(Object.assign({targets:t,duration:200,easing:"linear",begin(){p&&p()},complete(){C(t,m),d&&d()}},s)).play()},E=(t,l,d)=>{F({targets:typeof l=="number"&&typeof t!="number"?t.parentNode:document.scrollingElement,duration:500,easing:"easeInOutQuad",scrollTop:l||(typeof t=="number"?t:t?$(t)+document.documentElement.scrollTop-W:0),complete(){d&&d()}}).play()};v();v();var y={set(t,l){localStorage.setItem(t,l)},get(t){return localStorage.getItem(t)},del(t){localStorage.removeItem(t)}};var X=t=>{if(!t)return;let l=f(O,"div",{innerHTML:t,className:"tip"});setTimeout(()=>{l.addClass("hide"),setTimeout(()=>{O.removeChild(l)},300)},3e3)},ue=()=>{w.auto_scroll&&y.set(S,String(U.y))},pe=t=>{let l=window.location.hash,d=null;if(_){y.del(S);return}l?d=document.querySelector(decodeURI(l)):d=w.auto_scroll?parseInt(y.get(S)):0,d&&(E(d),j(1)),t&&l&&!_&&(E(d),j(1))},me=(t,l)=>{navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(t).then(()=>{l&&l(!0)},()=>{l&&l(!1)}):(console.error("Too old browser, clipborad API not supported."),l&&l(!1))};v();v();var R=()=>{let t;D.each("div.tab",l=>{if(l.getAttribute("data-ready"))return;let d=l.getAttribute("data-id"),p=l.getAttribute("data-title"),s=document.getElementById(d);s?t=!1:(s=document.createElement("div"),s.className="tabs",s.id=d,s.innerHTML='<div class="show-btn"></div>',s.querySelector(".show-btn").addEventListener("click",()=>{E(s)}),l.parentNode.insertBefore(s,l),t=!0);let m=s.querySelector(".nav ul");m||(m=f(s,"div",{className:"nav",innerHTML:"<ul></ul>"}).querySelector("ul"));let o=f(m,"li",{innerHTML:p});t&&(o.addClass("active"),l.addClass("active")),o.addEventListener("click",i=>{let x=i.currentTarget;s.find(".active").forEach(b=>{b.removeClass("active")}),l.addClass("active"),x.addClass("active")}),s.appendChild(l),l.setAttribute("data-ready",String(!0))})};var A=null,B=/mobile/i.test(window.navigator.userAgent),Ne=(t,l)=>{let d={el:{},create(){t.player.options.btns&&t.player.options.btns.forEach(e=>{d.el[e]||(d.el[e]=f(t,"div",{className:e+" btn",onclick(a){t.player.fetch().then(()=>{t.player.options.events[e](a)})}}))})}},p={el:null,btns:{mode:void 0,volume:void 0},step:"next",create:()=>{if(!t.player.options.controls)return;let e=p;t.player.options.controls.forEach(a=>{if(e.btns[a])return;let r={onclick(u){e.events[a]?e.events[a](u):t.player.options.events[a](u)}};switch(a){case"volume":r.className=" "+(o.muted?"off":"on"),r.innerHTML='<div class="bar"></div>',r["on"+h.nameMap.dragStart]=e.events.volume,r.onclick=null;break;case"mode":r.className=" "+t.player.options.mode;break;default:r.className="";break}r.className=a+r.className+" btn",e.btns[a]=f(e.el,"div",r)}),e.btns.volume.bar=e.btns.volume.querySelector(".bar")},events:{mode(e){switch(t.player.options.mode){case"loop":t.player.options.mode="random";break;case"random":t.player.options.mode="order";break;default:t.player.options.mode="loop"}p.btns.mode.className="mode "+t.player.options.mode+" btn",y.set("_PlayerMode",t.player.options.mode)},volume(e){e.preventDefault();let a=e.currentTarget,r=!1,u=c=>{c.preventDefault(),t.player.volume(p.percent(c,a)),r=!0},n=c=>{c.preventDefault(),a.removeEventListener(h.nameMap.dragEnd,n),a.removeEventListener(h.nameMap.dragMove,u),r?(t.player.muted(),t.player.volume(p.percent(c,a))):o.muted?(t.player.muted(),t.player.volume(o.volume)):(t.player.muted("muted"),p.update(0))};a.addEventListener(h.nameMap.dragMove,u),a.addEventListener(h.nameMap.dragEnd,n)},backward(e){p.step="prev",t.player.mode()},forward(e){p.step="next",t.player.mode()}},update(e){p.btns.volume.className="volume "+(!o.muted&&e>0?"on":"off")+" btn",q(p.btns.volume.bar,Math.floor(e*100)+"%")},percent(e,a){let r=((e.clientX||e.changedTouches[0].clientX)-I(a))/P(a);return r=Math.max(r,0),Math.min(r,1)}},s={el:null,bar:null,create(){let e=i.current().el;e&&(s.el&&(s.el.parentNode.removeClass("current").removeEventListener(h.nameMap.dragStart,s.drag),s.el.remove()),s.el=f(e,"div",{className:"progress"}),s.el.setAttribute("data-dtime",h.secondToTime(0)),s.bar=f(s.el,"div",{className:"bar"}),e.addClass("current"),e.addEventListener(h.nameMap.dragStart,s.drag),i.scroll())},update(e){q(s.bar,Math.floor(e*100)+"%"),s.el.setAttribute("data-ptime",h.secondToTime(e*o.duration))},seeking(e){e?s.el.addClass("seeking"):s.el.removeClass("seeking")},percent(e,a){let r=((e.clientX||e.changedTouches[0].clientX)-I(a))/P(a);return r=Math.max(r,0),Math.min(r,1)},drag(e){e.preventDefault();let a=i.current().el,r=n=>{n.preventDefault();let c=s.percent(n,a);s.update(c),H.update(c*o.duration)},u=n=>{n.preventDefault(),a.removeEventListener(h.nameMap.dragEnd,u),a.removeEventListener(h.nameMap.dragMove,r);let c=s.percent(n,a);s.update(c),t.player.seek(c*o.duration),o.disableTimeupdate=!1,s.seeking(!1)};o.disableTimeupdate=!0,s.seeking(!0),a.addEventListener(h.nameMap.dragMove,r),a.addEventListener(h.nameMap.dragEnd,u)}},m={el:null,create(){let e=i.current();m.el.innerHTML='<div class="cover"><div class="disc"><img src="'+e.cover+'" class="blur"  alt="music cover"/></div></div><div class="info"><h4 class="title">'+e.name+"</h4><span>"+e.artist+'</span><div class="lrc"></div></div>',m.el.querySelector(".cover").addEventListener("click",t.player.options.events["play-pause"]),H.create(m.el.querySelector(".lrc"))}},o,i={el:null,data:[],index:-1,errnum:0,add:(e,a)=>{a.forEach(r=>{r.group=e,r.name=r.name||r.title||"Meida name",r.artist=r.artist||r.author||"Anonymous",r.cover=r.cover||r.pic,r.type=r.type||"normal",i.data.push(r)})},clear(){i.data=[],i.el.innerHTML="",i.index!==-1&&(i.index=-1,t.player.fetch())},create(){let e=i.el;i.data.map((a,r)=>{if(a.el)return null;let u="list-"+t.player._id+"-"+a.group,n=document.getElementById(u);return n||(n=f(e,"div",{id:u,className:t.player.group?"tab":"",innerHTML:"<ol></ol>"}),t.player.group&&(n.setAttribute("data-title",t.player.options.rawList[a.group].title),n.setAttribute("data-id",t.player._id))),a.el=f(n.querySelector("ol"),"li",{title:a.name+" - "+a.artist,innerHTML:'<span class="info"><span>'+a.name+"</span><span>"+a.artist+"</span></span>",onclick(c){let T=c.currentTarget;if(i.index===r&&s.el){o.paused?t.player.play():t.player.seek(o.duration*s.percent(c,T));return}t.player.switch(r),t.player.play()}}),a}),R()},current(){return this.data[this.index]},scroll(){let e=this.current(),a=this.el.querySelector("li.active");a&&a.removeClass("active");let r=this.el.querySelector(".tab.active");return r&&r.removeClass("active"),a=this.el.querySelectorAll(".nav li")[e.group],a&&a.addClass("active"),r=this.el.querySelectorAll(".tab")[e.group],r&&r.addClass("active"),E(e.el,e.el.offsetTop),this},title(){if(o.paused)return;let e=this.current();document.title="Now Playing..."+e.name+" - "+e.artist+" | "+k},error(){let e=this.current();e.el.removeClass("current").addClass("error"),e.error=!0,this.errnum++}},x={el:null,create(){this.el||(this.el=f(t,"div",{className:"player-info",innerHTML:(t.player.options.type==="audio"?'<div class="preview"></div>':"")+'<div class="controller"></div><div class="playlist"></div>'},"after"),m.el=this.el.querySelector(".preview"),i.el=this.el.querySelector(".playlist"),p.el=this.el.querySelector(".controller"))},hide(){let e=this.el;e.addClass("hide"),window.setTimeout(()=>{e.removeClass("show hide")},300)}},b={type:"audio",mode:"random",btns:["play-pause","music"],controls:["mode","backward","play-pause","forward","volume"],events:{"play-pause"(e){o.paused?t.player.play():t.player.pause()},music(e){x.el.hasClass("show")?x.hide():(x.el.addClass("show"),i.scroll().title())}}},h={random(e){return Math.floor(Math.random()*e)},parse(e){let a=[];return[["music.163.com.*song.*id=(\\d+)","netease","song"],["music.163.com.*album.*id=(\\d+)","netease","album"],["music.163.com.*artist.*id=(\\d+)","netease","artist"],["music.163.com.*playlist.*id=(\\d+)","netease","playlist"],["music.163.com.*discover/toplist.*id=(\\d+)","netease","playlist"],["y.qq.com.*song/(\\w+)(.html)?","tencent","song"],["y.qq.com.*album/(\\w+)(.html)?","tencent","album"],["y.qq.com.*singer/(\\w+)(.html)?","tencent","artist"],["y.qq.com.*playsquare/(\\w+)(.html)?","tencent","playlist"],["y.qq.com.*playlist/(\\w+)(.html)?","tencent","playlist"],["xiami.com.*song/(\\w+)","xiami","song"],["xiami.com.*album/(\\w+)","xiami","album"],["xiami.com.*artist/(\\w+)","xiami","artist"],["xiami.com.*collect/(\\w+)","xiami","playlist"]].forEach(r=>{let n=new RegExp(r[0]).exec(e);n!==null&&(a=[r[1],r[2],n[1]])}),a},fetch(e){let a=[];return new Promise((r,u)=>{e.forEach(n=>{let c=h.parse(n);if(c[0]){let T=JSON.stringify(c),M=y.get(T);M?(a.push(...JSON.parse(M)),r(a)):fetch(`${w.playerAPI}/meting/?server=`+c[0]+"&type="+c[1]+"&id="+c[2]+"&r="+Math.random()).then(g=>g.json()).then(g=>{y.set(T,JSON.stringify(g)),a.push(...g),r(a)}).catch(g=>{})}else a.push(n),r(a)})})},secondToTime(e){let a=c=>isNaN(c)?"00":c<10?"0"+c:""+c,r=Math.floor(e/3600),u=Math.floor((e-r*3600)/60),n=Math.floor(e-r*3600-u*60);return(r>0?[r,u,n]:[u,n]).map(a).join(":")},nameMap:{dragStart:B?"touchstart":"mousedown",dragMove:B?"touchmove":"mousemove",dragEnd:B?"touchend":"mouseup"}};o=null,t.player={_id:h.random(999999),group:!0,load(e){let a="";e&&e.length>0?this.options.rawList!==e&&(this.options.rawList=e,i.clear(),this.fetch()):(a="none",this.pause());for(let r in d.el)C(d.el[r],a);return this},fetch(){return new Promise((e,a)=>{if(i.data.length>0)e(!1);else if(this.options.rawList){let r=[];this.options.rawList.forEach((u,n)=>{r.push(new Promise((c,T)=>{let M=n,g;u.list?(this.group=!0,g=u.list):(M=0,this.group=!1,g=[u]),h.fetch(g).then(L=>{i.add(M,L),c(0)})}))}),Promise.all(r).then(()=>{e(!0)})}}).then(e=>{e&&(i.create(),p.create(),this.mode())})},mode(){let e=i.data.length;if(!e||i.errnum===e)return;let a=p.step==="next"?1:-1,r=()=>{let n=i.index+a;(n>e||n<0)&&(n=p.step==="next"?0:e-1),i.index=n},u=()=>{let n=h.random(e);i.index!==n?i.index=n:r()};switch(this.options.mode){case"random":u();break;case"order":r();break;case"loop":p.step&&r(),i.index===-1&&u();break}this.init()},switch(e){typeof e=="number"&&e!==i.index&&i.current()&&!i.current().error&&(i.index=e,this.init())},init(){let e=i.current();if(!e||e.error){this.mode();return}let a=!1;o.paused||(a=!0,this.stop()),o.setAttribute("src",e.url),o.setAttribute("title",e.name+" - "+e.artist),this.volume(y.get("_PlayerVolume")||"0.7"),this.muted(y.get("_PlayerMuted")),s.create(),this.options.type==="audio"&&m.create(),a===!0&&this.play()},play(){if(A&&A.player.pause(),i.current().error){this.mode();return}o.play().then(()=>{i.scroll()}).catch(e=>{})},pause(){o.pause(),document.title=k},stop(){o.pause(),o.currentTime=0,document.title=k},seek(e){e=Math.max(e,0),e=Math.min(e,o.duration),o.currentTime=e,s.update(e/o.duration)},muted(e){e==="muted"?(o.muted=e,y.set("_PlayerMuted",e),p.update(0)):(y.del("_PlayerMuted"),o.muted=!1,p.update(o.volume))},volume(e){isNaN(e)||(p.update(e),y.set("_PlayerVolume",e),o.volume=e)},mini(){x.hide()}};let H={el:null,data:null,index:0,create(e){let a=i.index,r=i.current().lrc,u=n=>{if(a!==i.index)return;this.data=this.parse(n);let c="";this.data.forEach((T,M)=>{c+="<p"+(M===0?' class="current"':"")+">"+T[1]+"</p>"}),this.el=f(e,"div",{className:"inner",innerHTML:c},"replace"),this.index=0};r.startsWith("http")?this.fetch(r,u):u(r)},update(e){if(this.data&&(this.index>this.data.length-1||e<this.data[this.index][0]||!this.data[this.index+1]||e>=this.data[this.index+1][0])){for(let a=0;a<this.data.length;a++)if(e>=this.data[a][0]&&(!this.data[a+1]||e<this.data[a+1][0])){this.index=a;let r=-(this.index-1);this.el.style.transform="translateY("+r+"rem)",this.el.getElementsByClassName("current")[0].removeClass("current"),this.el.getElementsByTagName("p")[a].addClass("current")}}},parse(e){if(e){e=e.replace(/([^\]^\n])\[/g,(n,c)=>c+`
[`);let a=e.split(`
`),r=[],u=a.length;for(let n=0;n<u;n++){let c=a[n].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),T=a[n].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").trim();if(c){let M=c.length;for(let g=0;g<M;g++){let L=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(c[g]),J=L[1]*60,Y=parseInt(L[2]),V=L[4]?parseInt(L[4])/((L[4]+"").length===2?100:1e3):0,Q=J+Y+V;r.push([Q,T])}}}return r=r.filter(n=>n[1]),r.sort((n,c)=>n[0]-c[0]),r}else return[]},fetch(e,a){fetch(e).then(r=>r.text()).then(r=>{a(r)}).catch(r=>{})}},G={onerror(){i.error(),t.player.mode()},ondurationchange(){o.duration!==1&&s.el.setAttribute("data-dtime",h.secondToTime(o.duration))},onloadedmetadata(){t.player.seek(0),s.el.setAttribute("data-dtime",h.secondToTime(o.duration))},onplay(){t.parentNode.addClass("playing"),X(this.getAttribute("title")),A=t},onpause(){t.parentNode.removeClass("playing"),A=null},ontimeupdate(){this.disableTimeupdate||(s.update(this.currentTime/this.duration),H.update(this.currentTime))},onended(e){t.player.mode(),t.player.play()}};return(e=>{t.player.created||(t.player.options=Object.assign(b,e),t.player.options.mode=y.get("_PlayerMode")||t.player.options.mode,d.create(),o=f(t,t.player.options.type,G),x.create(),t.parentNode.addClass(t.player.options.type),t.player.created=!0)})(l),t};v();var Ae=t=>{let{text:l,parentNode:d,id:p,className:s,type:m,src:o,dataset:i}=t,x=l||t.textContent||t.innerHTML||"";d.removeChild(t);let b=document.createElement("script");p&&(b.id=p),s&&(b.className=s),m&&(b.type=m),o&&(b.src=o,b.async=!1),i.pjax!==void 0&&(b.dataset.pjax=""),x!==""&&b.appendChild(document.createTextNode(x)),d.appendChild(b)};v();var z=(t,l)=>{let d=w[t][l].url;return d.startsWith("https")?d:d.startsWith("http")?(console.warn(`Upgrade vendor ${t}/${l} to HTTPS, Please use HTTPS url instead of HTTP url.`),d.replace("http","https")):`/${d}`};var je=(t,l)=>{if(!window["css"+t]&&LOCAL[t]){let d={rel:"stylesheet",href:z("css",t)},p=w.css[t];p.local||(d.integrity=p.sri,d.crossOrigin="anonymous"),f(document.head,"link",d),window["css"+t]=!0}};export{re as a,E as b,y as c,X as d,ue as e,pe as f,me as g,R as h,Ne as i,Ae as j,je as k};
